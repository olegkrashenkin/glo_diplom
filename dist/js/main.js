/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";const e=({timing:e,draw:t,duration:o})=>{let n=performance.now();requestAnimationFrame((function a(l){let r=(l-n)/o;r>1&&(r=1);let c=e(r);t(c),r<1&&requestAnimationFrame(a)}))},t=document.querySelector(".overlay"),o=200,n=({modal:t,overlay:n,isShow:a=!0,isDocument:l=!1})=>{e(a?{duration:o,timing:e=>e,draw(e){t.style.top=l?-50*(1-e)+"%":50*e+"%",n.style.opacity=e,t.style.opacity=e}}:{duration:o,timing:e=>e,draw(e){t.style.top=l?-50*e+"%":50*(1-e)+"%",n.style.opacity=1-e,t.style.opacity=1-e}})},a=e=>{n({modal:e,overlay:t,isShow:!1}),setTimeout((()=>{t.style.display="none",e.style.display="none"}),o)},l=(e,o,l)=>{const r=document.querySelectorAll(e),c=document.querySelector(o);t.style.opacity="0",c.style.opacity="0",r.forEach((e=>{e.addEventListener("click",(e=>{e.preventDefault(),t.style.display="block",c.style.display="block",n({modal:c,overlay:t})}))})),c.addEventListener("click",(e=>{e.target.closest(l)&&a(c)}))};let r,c,s,i,d,u;l(".button>a",".header-modal",".header-modal__close"),l(".service-button>a",".services-modal",".services-modal__close"),(e=>{let a;document.querySelectorAll(".sertificate-document").forEach((e=>{e.classList.add("document-inner"),e.addEventListener("click",(e=>{e.preventDefault();const l=()=>{n({modal:a,overlay:t,isShow:!1,isDocument:!0}),setTimeout((()=>{t.style.display="none",a.remove()}),o),t.removeEventListener("click",l)};a=document.createElement("div"),a.style.cssText=`\n                background-image: url('${e.target.parentNode.pathname}');\n                background-position: center;\n                background-repeat: no-repeat;\n                background-size: contain;\n                position: relative;\n                margin: auto;\n                max-width: 68vh;\n                height: 100%;\n                opacity: 0\n            `,t.append(a),a=t.querySelector("div"),t.style.display="block",n({modal:a,overlay:t,isDocument:!0}),t.addEventListener("click",l)}))}))})(),(e=>{const t=document.querySelector(".smooth-scroll");t.style.visibility="hidden",t.style.cursor="pointer",document.addEventListener("scroll",(()=>{const e=document.documentElement.scrollTop;e>700?(t.style.opacity=e/1e4*4+"",t.style.visibility="visible"):t.style.visibility="hidden"})),t.addEventListener("click",(()=>{document.body.scrollIntoView({behavior:"smooth",block:"start"})}))})(),(e=>{const t=document.querySelectorAll(".count_1>span"),o=document.querySelectorAll(".count_2>span"),n=document.querySelectorAll(".count_3>span"),a=document.querySelectorAll(".count_4>span"),l=()=>{const e=(()=>{const e=(new Date("20 january 2023").getTime()-(new Date).getTime())/1e3;return{timeRemaning:e,days:Math.floor(e/60/60/24),hours:Math.floor(e/60/60%24),minutes:Math.floor(e/60%60),seconds:Math.floor(e%60)}})(),r=(e,t,o=!1)=>{o?e.forEach((e=>{e.textContent="00"})):e.forEach((e=>{e.textContent=`0${t}`.slice(-2)}))};e.timeRemaning>0?(r(t,e.days),r(o,e.hours),r(n,e.minutes),r(a,e.seconds)):(r(t,e.days,!0),r(o,e.hours,!0),r(n,e.minutes,!0),r(a,e.seconds,!0),clearInterval(l))};l(),setInterval(l,1e3)})(),document.body.classList.contains("balkony")&&(()=>{const t=document.getElementById("calc"),o=document.getElementById("calc-type"),n=document.getElementById("calc-type-material"),a=document.getElementById("calc-input"),l=document.getElementById("calc-total");t.addEventListener("input",(t=>{var r;"calc-input"===t.target.id&&((r=t).target.value=r.target.value.replace(/\D+/g,"")),(()=>{const t=+o.options[o.selectedIndex].value,r=+n.options[n.selectedIndex].value,c=+a.value;if(t&&r&&c){const o=t*r*c;e({duration:200,timing:e=>e,draw(e){l.value=Math.round(e*o)}})}})()}))})(),(()=>{const e=document.querySelectorAll(".rf"),t=(e,t)=>{const o=['form[name="action-form"]','form[name="action-form2"]','form[name="callback-form"]','form[name="application-form"]'],n=e=>{e.name===t&&(e.style.border="1px solid red",setTimeout((()=>{e.style.border="none"}),1e3))};for(const t of o)if(e.target.closest(t))return void e.target.closest(t).querySelectorAll("input").forEach((e=>n(e)))};e.forEach((e=>{e.addEventListener("input",(e=>{switch(e.target.name){case"fio":return(t=e).target.value=t.target.value.replace(/[^a-zа-яё]+/gi,""),void(d=t.target.value);case"phone":return void(u=((e,t)=>{let o;return o=t?17:16,e.target.value.length<=o?e.target.value.length>1?e.target.value=e.target.value[0]+e.target.value.substring(1).replace(/[^\d]/,""):e.target.value=e.target.value.replace(/[^\d\+]/,""):e.target.value=e.target.value.substring(0,o),e.target.value})(e,"+"===e.target.value[0]))}var t})),e.addEventListener("click",(o=>{o.preventDefault();const n={name:d,phone:u};if("submit"===o.target.type&&d&&u){const t=document.getElementById("calc-total");r=e.closest(".header-modal, .services-modal"),c=e.querySelectorAll("input"),s=o.target,i=o.target.textContent,document.body.classList.contains("balkony")&&t&&""!=t.value&&(n.total=t.value),(async e=>{s.textContent="Загрузка...";const t=()=>{setTimeout((()=>{d="",u="",c.forEach((e=>e.value="")),s.textContent=i,r&&a(r)}),2500)};fetch("https://jsonplaceholder.typicode.com/posts",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then((e=>{if(e.ok)return s.textContent="Заявка принята!",t(),e.json()})).catch((e=>{s.textContent="Ошибка!",t()}))})(n)}else"submit"!==o.target.type||d||t(o,"fio");"submit"!==o.target.type||u||t(o,"phone")}))}))})()})();